SELECT 
    AP.DIAGNOSTICO_PRINCIPAL AS CODIGO_DIAGNOSTICO,
    CIE10.NOMBRE AS NOMBRE_ENFERMEDAD,
    COUNT(*) AS FRECUENCIA
FROM 
    AP
JOIN 
    CIE10 ON AP.DIAGNOSTICO_PRINCIPAL = CIE10.CODIGO
GROUP BY 
    AP.DIAGNOSTICO_PRINCIPAL, CIE10.NOMBRE
ORDER BY 
    FRECUENCIA DESC;